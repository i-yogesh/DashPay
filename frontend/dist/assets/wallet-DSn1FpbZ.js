import{j as e,R as b,a as j,c as w,r as m,e as N,d as k,n as _}from"./index-C2qyRJXm.js";import{u as z}from"./uid-C1DJytti.js";import{a as u}from"./axios-B4uVmeYG.js";import{m as v}from"./index-D-oV7jEn.js";function C(t){const s=t.user,a=t.updateuser;return e.jsxs("div",{className:"sm:w-1/3 w-full h-full",children:[e.jsx("div",{className:"pl-5 text-4xl font-bold text-white",children:"Wallet"}),e.jsxs("div",{className:"bg-white p-5 rounded-lg  m-7 mb-0 shadow-md",children:[e.jsxs("div",{className:"flex flex-col items-center justify-center",children:[e.jsx("div",{className:"h-32 text-6xl font-bold text-center flex flex-col items-center justify-center overflow-auto",children:e.jsxs("div",{children:["₹ ",s.balance]})}),e.jsx("div",{className:"bg-indigo-100 text-indigo-800 text-3xl font-medium me-2 px-2.5 py-0.5 rounded-full dark:bg-indigo-900 dark:text-indigo-300",children:"Account Balance"}),e.jsx("button",{onClick:a,className:"mt-4 relative inline-flex items-center justify-center p-0.5 mb-2 me-2 overflow-hidden text-sm font-medium text-gray-900 rounded-lg group bg-gradient-to-br from-cyan-500 to-blue-500 group-hover:from-cyan-500 group-hover:to-blue-500 hover:text-white dark:text-white focus:ring-4 focus:outline-none focus:ring-cyan-200 dark:focus:ring-cyan-800",children:e.jsx("span",{className:"relative px-5 py-2.5 transition-all ease-in duration-75 bg-white dark:bg-gray-900 rounded-md group-hover:bg-opacity-0",children:e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor",className:"size-6",children:[e.jsx("path",{strokeLinecap:"round","stroke-linejoin":"round",d:"M16.023 9.348h4.992v-.001M2.985 19.644v-4.992m0 0h4.992m-4.993 0 3.181 3.183a8.25 8.25 0 0 0 13.803-3.7M4.031 9.865a8.25 8.25 0 0 1 13.803-3.7l3.181 3.182m0-4.991v4.99"}),"Refresh"]})})})]}),e.jsx("span",{className:"bg-blue-100 text-blue-800 text-xl font-medium me-2 px-2.5 py-0.5 rounded dark:bg-blue-900 dark:text-blue-300",children:"Account Details"}),e.jsxs("div",{className:"pt-3 flex ",children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"size-6",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M21.75 6.75v10.5a2.25 2.25 0 0 1-2.25 2.25h-15a2.25 2.25 0 0 1-2.25-2.25V6.75m19.5 0A2.25 2.25 0 0 0 19.5 4.5h-15a2.25 2.25 0 0 0-2.25 2.25m19.5 0v.243a2.25 2.25 0 0 1-1.07 1.916l-7.5 4.615a2.25 2.25 0 0 1-2.36 0L3.32 8.91a2.25 2.25 0 0 1-1.07-1.916V6.75"})}),e.jsxs("div",{className:"ml-4 bg-blue-100 text-blue-800 text-l font-medium me-2 px-2.5 py-0.5 rounded dark:bg-gray-700 dark:text-blue-400 border border-blue-400",children:[" ",s.email]})]}),e.jsxs("div",{className:"pt-3 flex",children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"size-6",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M2.25 6.75c0 8.284 6.716 15 15 15h2.25a2.25 2.25 0 0 0 2.25-2.25v-1.372c0-.516-.351-.966-.852-1.091l-4.423-1.106c-.44-.11-.902.055-1.173.417l-.97 1.293c-.282.376-.769.542-1.21.38a12.035 12.035 0 0 1-7.143-7.143c-.162-.441.004-.928.38-1.21l1.293-.97c.363-.271.527-.734.417-1.173L6.963 3.102a1.125 1.125 0 0 0-1.091-.852H4.5A2.25 2.25 0 0 0 2.25 4.5v2.25Z"})}),e.jsxs("div",{className:"ml-4 bg-blue-100 text-blue-800 text-l font-medium me-2 px-2.5 py-0.5 rounded dark:bg-gray-700 dark:text-blue-400 border border-blue-400",children:[" ",s.number]})]}),e.jsxs("div",{className:"pt-3 flex",children:[e.jsx("img",{src:z,alt:"",width:25}),e.jsxs("div",{className:"ml-4 bg-blue-100 text-blue-800 text-l font-medium me-2 px-2.5 py-0.5 rounded dark:bg-gray-700 dark:text-blue-400 border border-blue-400",children:[" ",s.uid]})]}),e.jsx("div",{className:"flex justify-center pt-3",children:e.jsx("button",{type:"button",className:"text-white bg-gradient-to-r from-cyan-400 via-cyan-500 to-cyan-600 hover:bg-gradient-to-br focus:ring-4 focus:outline-none focus:ring-cyan-300 dark:focus:ring-cyan-800 shadow-lg shadow-cyan-500/50 dark:shadow-lg dark:shadow-cyan-800/80 font-medium rounded-lg text-xl px-5 py-2.5 text-center me-2 mb-2",children:"Reset Wallet Pin"})})]})]})}const R="/assets/Razorpay_logo-GFkJt44a.svg",A="/assets/cashfree-DDnfnE3a.png";function S(t){const s=b(j),a=b(w),n=m.useRef(null),[d,f]=m.useState("");function h(){const o=sessionStorage.getItem("token");if(n.current){const l=n.current.value;u.post(a+"/payment/razorpayorder",{user_id:s._id,amount:l},{headers:{Authorization:o}}).then(r=>{const g={key:r.data.key_id,amount:r.data.amount,currency:r.data.currency,name:"Add Money",description:"Add Money to Wallet",image:"https://upload.wikimedia.org/wikipedia/commons/8/89/Razorpay_logo.svg",order_id:r.data.id,handler:function(p){u.post(a+"/payment/razorpayverify",{_id:s._id,amount:l,response:p},{headers:{Authorization:o}}).then(i=>{t.f(),t.updateuser(),t.toggle(!1),alert(i.data.message)}).catch(i=>{alert(i.response.data.error)})},prefill:{name:s.name,email:s.email,contact:s.phone},theme:{color:"#3399cc"}};new window.Razorpay(g).open()}).catch(r=>{console.error(r),alert(r.response.data.error)})}else alert("Please enter a valid amount.")}function x(){if(n.current===null){alert("Please enter a valid amount");return}const o=n.current.value,l=sessionStorage.getItem("token");u.post(a+"/payment/cashfreeorder",{user_id:s._id,amount:o},{headers:{Authorization:l}}).then(r=>{const g={mode:"sandbox"},y=new window.Cashfree(g);let p={paymentSessionId:r.data.response.payment_session_id,redirectTarget:"_modal"};y.checkout(p).then(i=>{i.error&&(console.log("User has closed the popup or there is some payment error, Check for Payment Status"),console.log(i.error)),i.redirect&&console.log("Payment will be redirected"),i.paymentDetails&&(console.log("Payment has been completed, Check for Payment Status"),u.post(a+"/payment/cashfreeverify",{_id:s._id,amount:o,order_id:r.data.response.order_id},{headers:{Authorization:l}}).then(()=>{t.f(),t.updateuser(),t.toggle(!1),alert("Payment Successful")}))})}).catch(r=>{console.error(r),alert(r.response.data.error)})}function c(){d==="Razorpay"?h():d==="CashFree"&&x()}return e.jsx("div",{className:"w-full bg-gray-100 p-2",children:e.jsxs("div",{className:"bg-white shadow-md rounded-lg p-8 h-full w-full",children:[e.jsx("h2",{className:"text-xl font-semibold mb-4",children:"Payment Information"}),e.jsxs("div",{className:"w-full h-full flex justify-center items-center flex-col gap-5 pb-9",children:[e.jsx("input",{type:"text",ref:n,placeholder:"Enter the amount",className:"rounded-xl text-center"}),e.jsx("h1",{className:"font-bold text-2xl",children:"Chose Payment Options"})]}),e.jsxs("div",{className:"flex justify-center flex-col sm:flex-row items-center mb-4 gap-7",children:[e.jsx("img",{src:R,onClick:()=>f("Razorpay"),alt:"Razorpay_logo",className:"w-64 hover:cursor-pointer hover:scale-110 transition-all"}),e.jsx("img",{src:A,onClick:()=>f("CashFree"),alt:"Cashfree_logo",className:"w-64 hover:cursor-pointer hover:scale-110 transition-all"})]}),e.jsx("div",{className:"flex justify-center items-center",children:d==="Razorpay"&&e.jsx("button",{onClick:c,className:"font-bold bg-blue-800 text-white p-2 rounded-lg",children:"Pay with Razorpay"})||d==="CashFree"&&e.jsx("button",{onClick:c,className:"font-bold bg-blue-800 text-white p-2 rounded-lg",children:"Pay with CashFree"})})]})})}function P(t){const[s,a]=m.useState(0),n=t.trx;return m.useEffect(()=>{n.length===0&&s===0&&(a(1),t.f())},[n]),e.jsx("div",{className:"h-auto",children:n.length===0?e.jsx("div",{className:"text-center text-2xl font-bold text-gray-500",children:"No Transactions"}):e.jsx(D,{data:n})})}function D(t){return e.jsxs("div",{className:"p-3 h-full",children:[e.jsxs("div",{className:"hidden sm:flex justify-around w-full border-b border-gray-300",children:[e.jsx("div",{className:"p-2 font-bold",children:"Transaction ID"}),e.jsx("div",{className:"p-2 font-bold",children:"Amount"}),e.jsx("div",{className:"p-2 font-bold",children:"Date & Time"})]}),e.jsx("div",{className:"h-96 overflow-y-scroll",children:t.data.map(s=>e.jsx(M,{data:s}))})]})}function M(t){function s(a){return v(a).tz(v.tz.guess()).format("YYYY-MM-DD hh:mm:ss A (z)")}return e.jsxs("div",{className:"sm:grid sm:grid-cols-3 w-full border-b border-gray-300",children:[e.jsxs("div",{className:"p-2",children:[e.jsx("span",{className:"sm:hidden",children:"TxiD: "}),t.data.id]}),e.jsxs("div",{className:"pl-2 sm:p-2  text-green-600",children:["+ ₹",t.data.amount]}),e.jsx("div",{className:"p-2",children:s(new Date(t.data.date))})]})}function T(t){const[s,a]=m.useState(!1);return e.jsxs("div",{className:"bg-white  rounded-lg sm:w-2/3 m-7 min-h-full shadow-md",children:[e.jsxs("div",{className:"flex justify-around h-20",children:[e.jsx("div",{onClick:()=>a(!1),className:(s?" ":"bg-cyan-300 rounded-lg ")+"  text-center w-full flex flex-col items-center justify-center font-semibold text-xl hover:text-2xl transition-all cursor-pointer ",children:e.jsx("div",{children:"Wallet Credit History"})}),e.jsx("div",{onClick:()=>a(!0),className:(s?"bg-cyan-300 rounded-lg ":" ")+"  w-full flex flex-col items-center justify-center font-semibold text-xl hover:text-2xl transition-all cursor-pointer ",children:e.jsx("div",{children:"Add Money"})})]}),s?e.jsx(S,{f:t.f,updateuser:t.updateuser,toggle:a}):e.jsx(P,{trx:t.trx,f:t.f})]})}function E(){const[t,s]=N(j),a=b(w),[n,d]=m.useState([]);k(_)(2);const h=()=>{const c=t._id,o=sessionStorage.getItem("token");u.post(a+"/wallet",{id:c},{headers:{Authorization:o}}).then(l=>{d(l.data)}).catch(l=>{console.log(l)})};function x(){const c=sessionStorage.getItem("token");u.post(a+"/user",{id:t._id},{headers:{Authorization:c}}).then(o=>{s(o.data.resp)}).catch(o=>{console.log(o.response.data.error)})}return e.jsxs("div",{className:"sm:p-10 flex h-full sm:h-screen justify-center sm:flex-row flex-col bg-sky-700",children:[e.jsx(C,{func:h,user:t,updateuser:x}),e.jsx(T,{trx:n,f:h,updateuser:x})]})}export{E as default};
